磁盘组成
	一个磁盘有若干盘片组成
	一个盘片有上下两个可读写面
	一个面从逻辑上划分为若干磁道，一般最外圈的为0号磁道
	一个磁道从逻辑上划分为若干扇区，扇区为512 bytes
	各盘面对应位置的磁道组成一个柱面
	磁盘的空间使用顺序是：从低柱面到高柱面，
		在同一柱面中从低磁道到高磁道，
		在同一磁道中从低扇区到高扇区

磁盘寻址方式
	CHS，即通过Cylinder，Header，Sector来唯一确定某个扇区
	LBA，即Logic Block Address，通过将磁盘划分逻辑块进行寻址

存入磁盘的数据存储是大端/小端要注意读写一致性

分区体系的种类
	DOC分区体系，即常见的MBR（Master Boot Recorder）分区体系
	GUID分区体系，即全局分区表的分区体系

DOC分区体系
	磁盘的第一柱面的第一磁道的第一扇区，即磁盘的0号扇区，被称作
	MBR，因为该扇区中存放的数据是用于引导加载操作系统内核的程序
	以及磁盘的分区表
	
	MBR，446字节引导程序 + 64字节分区表 + 2字节签名（即55 AA）

	分区表，共分为4个区段，每段记录分区的磁盘范围（所以我们最多
		可以分4个主分区）

	分区表的区段，每段16字节，这16字节的内容如下：
		   1				2~4				5			6~8				9~12			13~16
	    引导标志		分区起始地址	分区类型	分区结束地址	分区起始的		分区的占用
	  0x00 不可引导		用CHS编址的					用CHS编址的		LBA逻辑地址		的扇区数
	  0x80 可以引导		扇区号						扇区号
	  CHS编码的3字节：0~7位用于存储磁头号，8~13位用于存储扇区号，14~23位用于存储柱面号

分区与文件系统
	对磁盘分区的目的是将磁盘从逻辑上划分成若干区块，这样可以加快
	数据的存取速度，同时对于磁盘故障时数据恢复也有极大的优势，并
	且不同的分区可以内建不同的文件系统，这样可以满足用户多样化的
	数据管理需求
	
	文件系统是磁盘与要进行存取数据的应用程序之间的中间体
	，它将数据的存取，管理对应用程序隐藏了起来，这样的话每个应用
	程序只要了解文件系统提供的数据存取API就可以实现数据的存取而不
	用了解磁盘的物理组成，此外文件系统还对数据的存取提供权限保护，
	优化加速数据读取等诸多特性，简单来讲文件系统是磁盘存取数据的
	软件接口

	我们常规的步骤是：对磁盘分区，格式化磁盘（该过程就是在相应的
	分区建立文件系统的过程）

文件系统的共性
	既然文件系统是数据存取的接口，那么文件系统一定要对数据的存取
	做一些规则约束，不同的文件系统有一些共同的规则。
	数据单元：一次读写数据的大小，在FAT和NTFS中称为Cluster，在Ext
			  中称为Block，创建文件系统时指定，大小为2次幂扇区
	坏数据单元：包含坏扇区的数据单元
	扇区有若干地址映射：LBA，物理卷地址，逻辑卷地址
	逻辑文件地址：一个文件在储存时会被分割成若干的数据单元进行储存，
				  对不同部分进行编号，即文件的逻辑地址
	空间分配策略：从头开始依次查找下一个数据单元，可用则进行分配
				  从最后分配地址处开始依次查找下一个数据单元，可用则分配
				  找出磁盘中跟文件大小近似的可用连续空间进行分配
	元数据：文件，目录名以及权限，时间等数据

FAT，File Allocation Table
	微软使用的文件系统，历经FAT12，FAT16，FAT32
	FAT的布局
		| 保留区 | FAT1-FAT2 | 数据区 |
	保留区又称DBR，即Dos Boot Recorder，FAT12，FAT16只占用0号扇区，FAT32
	还占用别的扇区用于DBR的备份，DBR中记录的信息有：
		每扇区字节数，每Cluster扇区数，保留区扇区数，FAT表个数，
		文件系统大小（扇区数），FAT表大小（扇区数），
		根目录起始Cluster号，其他信息。

	FAT表区域，用于记录数据区空间分配情况，以及文件目录的下一Cluster号

	数据区是用于实际存取数据的区域，以Cluster为单位

	我的课程设计中模拟的FAT16的结构是这样的：
		虚拟磁盘总共1000块，每块大小为1024 bytes

		0块用于储存文件系统的基本信息以及起始数据块的索引
		1~2块用于储存FAT表1
		3~4块用于储存FAT表2
		5~6块用于储存根目录数据
		7~999块用于储存文件/目录数据

		FAT表就相当于用数组储存链表的机制，每个表项的索引对应相应的块，
		表项的内容是当前块的后续块的表项索引，如果没有后续块则设置为特殊值

		FAT表2仅仅是用于FAT表的备份以及纠错的

		FAT表大小是由磁盘的数据块多少决定的，因为虚拟磁盘共1000个数据块，
		所以FAT表的表项要用16位数据表示，共1000项，所以FAT表的可以用1024*2表示

		每个文件或者目录项都是用一个FCB数据对其进行描述的，FCB中具体记录了
		该文件数据的文件名，扩展名，起始块索引，文件数据长度等信息

		目录跟文件都会被分配块进行储存的并且都会在空间不足时进行扩充，但是
		目录的块又会进行进一步划分为为fcb单位，也就是说目录下面储存的就是其
		中文件以及子目录的fcb信息而已

		每个目录在创建时都回添加两个子项 . 和 ..

		文件系统启动时就维护了一个文件打开列表，该列表中记录着打开的文件/目录
		的fcb数据，值得注意的是任何时候都仅有一个目录打开

		进入一个文件的流程：
			在打开文件列表中查找当前目录的fcb，通过fcb可以访问当前目录的所有数据项(fcb)
			，逐个比较文件名找到要打开文件的fcb，通过该fcb访问文件的数据

		打开文件列表是用于维护当前文件系统进入点信息的工具，而FAT表的作用在于将表示同
		一个文件或目录的数据块链接起来

		在目录下创建新项时要做的工作有：
			当前目录数据块中写入一个新的fcb
			为新建项分配一个空闲的数据块
			改变当前目录的 . 项中的length
			改变当前目录的父目录中对当前目录的fcb.length

